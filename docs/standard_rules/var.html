<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<title>Variables and Rulebooks</title>
<link href="../docs-assets/Breadcrumbs.css" rel="stylesheet" rev="stylesheet" type="text/css">
		<meta name="viewport" content="width=device-width initial-scale=1">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="Content-Language" content="en-gb">

<link href="../docs-assets/Contents.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Progress.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Navigation.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Fonts.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Base.css" rel="stylesheet" rev="stylesheet" type="text/css">
<script>
MathJax = {
    options: {
    	skipHtmlTags: {'[-]': ['pre']},
    	processHtmlClass: 'mathjax_process'
    },
	loader: {load: ['[tex]/texhtml']},
  	tex: {
		inlineMath: [ ['\\INWEBMATH(', '\\INWEBMATH)'] ],
    	packages: {'[+]': ['texhtml']},
    	allowTexHTML: true
	},
	svg: {
		fontCache: 'global'
	}
};
</script>
<script defer src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-svg.js"></script>

<script src="http://code.jquery.com/jquery-1.12.4.min.js"
	integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>

<script src="../docs-assets/Bigfoot.js"></script>
<link href="../docs-assets/Bigfoot.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Colours.css" rel="stylesheet" rev="stylesheet" type="text/css">
		
	</head>
	<body class="commentary-font">
		<nav role="navigation">
		<h1><a href="../index.html"><img src="../docs-assets/Inform.png" height=72> </a></h1>
<ul><li><a href="../index.html">home</a></li>
</ul><h2>Compiler</h2><ul>
<li><a href="../structure.html">structure</a></li>
<li><a href="../inbuildn.html">inbuild</a></li>
<li><a href="../inform7n.html">inform7</a></li>
<li><a href="../intern.html">inter</a></li>
<li><a href="../services.html">services</a></li>
<li><a href="../secrets.html">secrets</a></li>
</ul><h2>Other Tools</h2><ul>
<li><a href="../inblorbn.html">inblorb</a></li>
<li><a href="../inform6.html">inform6</a></li>
<li><a href="../inpolicyn.html">inpolicy</a></li>
</ul><h2>Resources</h2><ul>
<li><a href="../extensions.html">extensions</a></li>
<li><a href="../kits.html">kits</a></li>
</ul><h2>Repository</h2><ul>
<li><a href="https://github.com/ganelson/inform"><img src="../docs-assets/github.png" height=0> github</a></li>
</ul><h2>Related Projects</h2><ul>
<li><a href="https://github.com/ganelson/inweb"><img src="../docs-assets/github.png" height=0> inweb</a></li>
<li><a href="https://github.com/ganelson/intest"><img src="../docs-assets/github.png" height=0> intest</a></li>
</ul>
		</nav>
		<main role="main">
		<!-- Weave of 'Variables and Rulebooks' generated by inweb -->
<div class="breadcrumbs">
    <ul class="crumbs"><li><a href="../index.html">Home</a></li><li><a href="../extensions.html">Extensions</a></li><li><a href="index.html">Standard Rules</a></li><li><b>Variables and Rulebooks</b></li></ul></div>
<p class="purpose">The global variables and those built-in rulebooks which do not belong either to specific actions or to specific activities.</p>

<ul class="toc"><li><a href="var.html#SP1">&#167;1. The player's situation</a></li><li><a href="var.html#SP11">&#167;11. Rulebooks</a></li><li><a href="var.html#SP20">&#167;20. Rules</a></li><li><a href="var.html#SP21">&#167;21. Startup</a></li><li><a href="var.html#SP23">&#167;23. The turn sequence</a></li><li><a href="var.html#SP28">&#167;28. Shutdown</a></li><li><a href="var.html#SP29">&#167;29. Scene changing</a></li><li><a href="var.html#SP31">&#167;31. Action-processing</a></li><li><a href="var.html#SP36">&#167;36. Specific action-processing</a></li><li><a href="var.html#SP40">&#167;40. Player's action awareness</a></li><li><a href="var.html#SP41">&#167;41. Accessibility</a></li><li><a href="var.html#SP42">&#167;42. Reaching inside</a></li><li><a href="var.html#SP43">&#167;43. Reaching outside</a></li><li><a href="var.html#SP44">&#167;44. Visibility</a></li><li><a href="var.html#SP45">&#167;45. Does the player mean</a></li><li><a href="var.html#SP47">&#167;47. Adjectives applied to values</a></li><li><a href="var.html#SP48">&#167;48. Scene descriptions</a></li><li><a href="var.html#SP49">&#167;49. Command parser errors</a></li><li><a href="var.html#SP50">&#167;50. Internal rules</a></li></ul><hr class="tocbar">

<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP1" class="paragraph-anchor"></a><b>&#167;1. The player's situation.</b>  A set of global variables defines the player's current situation in
space and time.</p>
<p>Although users often think of the protagonist object as a fixed object
whose name is &quot;player&quot;, this is a variable, and it is possible to change
perspective during play and become somebody else -- at which point the
&quot;player&quot; variable will point to a different object.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">

<span class="plain-syntax">Part Three - Variables and Rulebooks</span>

<span class="plain-syntax">Chapter 1 - Variables</span>

<span class="plain-syntax">Section 1 - Situation</span>

<span class="plain-syntax">The player is a person that varies.</span>
<span class="plain-syntax">The player variable is defined by Inter as "player".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP2" class="paragraph-anchor"></a><b>&#167;2. </b>  The I7 variable &quot;location&quot; corresponds to I6's <code>real_location</code>, not
<code>location</code>. Its value is never equal to a pseudo-room representing darkness:
it is always an actual room, and I7 has nothing corresponding to I6's
<code>thedark</code> &quot;room&quot;. Similarly, we use an I7 variable &quot;darkness witnessed&quot; for a
flag which the I6 library would have stored as the <code>visited</code> attribute for the
<code>thedark</code> object.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">The location -- documented at var_location -- is an object that varies.</span>
<span class="plain-syntax">The score -- documented at var_score -- is a number that varies.</span>
<span class="plain-syntax">The last notified score is a number that varies.</span>
<span class="plain-syntax">The maximum score is a number that varies.</span>
<span class="plain-syntax">The turn count is a number that varies.</span>
<span class="plain-syntax">The time of day -- documented at var_time -- is a time that varies.</span>
<span class="plain-syntax">The darkness witnessed is a truth state that varies.</span>

<span class="plain-syntax">The location variable is defined by Inter as "real_location".</span>
<span class="plain-syntax">The score variable is defined by Inter as "score".</span>
<span class="plain-syntax">The last notified score variable is defined by Inter as "last_score".</span>
<span class="plain-syntax">The maximum score variable is defined by Inter as "MAX_SCORE".</span>
<span class="plain-syntax">The turn count variable is defined by Inter as "turns".</span>
<span class="plain-syntax">The time of day variable is defined by Inter as "the_time".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP3" class="paragraph-anchor"></a><b>&#167;3. </b>  It is arguable that &quot;noun&quot;, &quot;second noun&quot; and &quot;person asked&quot; ought
to be rulebook variables belonging to the action-processing rules, so that
they essentially did not exist outside of the context of an ongoing action.
The reason this isn't done is partly historical (rulebook variables were a
fairly late development, implemented in April 2007, though they had long
been planned). But it is sometimes useful to get at the nouns in an action
after it has finished, and making them global variables also makes them a
little faster to look up (a good thing since they are used so much), and
causes them to be indexed more prominently.</p>
<p>&quot;Item described&quot; is simply an I7 name for <code>self</code>. (This is an Inter variable
which refers to the object currently under discussion.) In early drafts of I7,
it was called &quot;this object&quot;, but somehow this raised expectations too high
about how often it would be meaningful: it looked like a pronoun running
meanings from sentence to sentence.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Section 2 - Current action</span>

<span class="plain-syntax">The noun -- documented at var_noun -- is an object that varies.</span>
<span class="plain-syntax">The second noun is an object that varies.</span>
<span class="plain-syntax">The person asked -- documented at var_person_asked -- is an object that varies.</span>
<span class="plain-syntax">The reason the action failed -- documented at var_reason -- is an action</span>
<span class="plain-syntax">based rule producing nothing that varies.</span>
<span class="plain-syntax">The item described is an object that varies.</span>

<span class="plain-syntax">The noun variable is defined by Inter as "noun".</span>
<span class="plain-syntax">The second noun variable is defined by Inter as "second".</span>
<span class="plain-syntax">The person asked variable is defined by Inter as "actor".</span>
<span class="plain-syntax">The reason the action failed variable is defined by Inter as "reason_the_action_failed".</span>
<span class="plain-syntax">The item described variable is defined by Inter as "self".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP4" class="paragraph-anchor"></a><b>&#167;4. </b>  &quot;Person reaching&quot; turns out to have exactly the same meaning as &quot;person
asked&quot; -- they are both the <code>actor</code>, in Inter terms, but are used in different
situations.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Section 3 - Used when ruling on accessibility</span>

<span class="plain-syntax">The person reaching -- documented at var_person_reaching -- is an object that varies.</span>
<span class="plain-syntax">The container in question is an object that varies.</span>
<span class="plain-syntax">The supporter in question is an object that varies.</span>
<span class="plain-syntax">The particular possession -- documented at var_particular -- is a thing that varies.</span>

<span class="plain-syntax">The person reaching variable is defined by Inter as "actor".</span>
<span class="plain-syntax">The container in question variable is defined by Inter as "parameter_object".</span>
<span class="plain-syntax">The supporter in question variable is defined by Inter as "parameter_object".</span>
<span class="plain-syntax">The particular possession variable is defined by Inter as "particular_possession".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP5" class="paragraph-anchor"></a><b>&#167;5. </b>  Parsing variables follow. The I6 parser tends to put any data read as part
of a command into the variable <code>parsed_number</code>, but then, Inter is typeless:
we can't have a single I7 variable for all these possibilities since it could
then have no legal type. We solve this as follows. Whenever a kind of value
\INWEBMATH(K\INWEBMATH) is created which can be parsed as part of a command, an I7 variable &quot;the
\INWEBMATH(K\INWEBMATH) understood&quot; is also created, as a \INWEBMATH(K\INWEBMATH) that varies. All of these variables
are translated into Inter's <code>parsed_number</code>, so in effect they provide aliases
of each possible type for the same underlying memory location. The one exception
is for &quot;the topic understood&quot; (for historical reasons this one is not called
&quot;the snippet understood&quot;, and so we make it by hand).</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Section 4 - Used when understanding typed commands</span>

<span class="plain-syntax">The player's command -- documented at var_command -- is a snippet that varies.</span>
<span class="plain-syntax">The matched text is a snippet that varies.</span>
<span class="plain-syntax">The topic understood is a snippet that varies.</span>
<span class="plain-syntax">The current item from the multiple object list is an object that varies.</span>

<span class="plain-syntax">The player's command variable is defined by Inter as "players_command".</span>
<span class="plain-syntax">The matched text variable is defined by Inter as "matched_text".</span>
<span class="plain-syntax">The topic understood variable is defined by Inter as "parsed_number".</span>
<span class="plain-syntax">The current item from the multiple object list variable is defined by Inter as</span>
<span class="plain-syntax">    "multiple_object_item".</span>
</pre>
<p class="commentary firstcommentary"><a id="SP6" class="paragraph-anchor"></a><b>&#167;6. </b> </p>

<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Section 5 - Presentation on screen</span>

<span class="plain-syntax">The command prompt -- documented at var_prompt -- is a text that varies.</span>
<span class="plain-syntax">The command prompt is "&gt;".</span>

<span class="plain-syntax">The left hand status line -- documented at var_sl -- is a text that varies.</span>
<span class="plain-syntax">The right hand status line is a text that varies.</span>

<span class="plain-syntax">The left hand status line variable is defined by Inter as "left_hand_status_line".</span>
<span class="plain-syntax">The right hand status line variable is defined by Inter as "right_hand_status_line".</span>

<span class="plain-syntax">The default status line rule is listed in the for constructing the status line rules.</span>
<span class="plain-syntax">The default status line rule is defined by Inter as "DEFAULT_STATUS_LINE_R".</span>

<span class="plain-syntax">The listing group size is a number that varies.</span>
<span class="plain-syntax">The listing group size variable is defined by Inter as "listing_size".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP7" class="paragraph-anchor"></a><b>&#167;7. </b>  Now some linguistic variables:</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Section 6 - Language generation</span>

<span class="plain-syntax">The prior named object is an object that varies.</span>
<span class="plain-syntax">The prior named object variable is defined by Inter as "prior_named_noun".</span>
<span class="plain-syntax">An object has a text called list grouping key.</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP8" class="paragraph-anchor"></a><b>&#167;8. </b>  ...but they are not the last global variables created by the Standard Rules.</p>
<p>These bibliographic data variables are concealed because they are under a
heading which ends with the word &quot;unindexed&quot;. There are two reasons why
these variables are unindexed: first, they appear in a different guise only
a little lower in the Contents index as part of the Library Card, and
second, we don't want users to think of them as manipulable during play.</p>
<p>Rather sneakily, we also define a Figure here. This is done in order to
make it legal to declare variables and properties of the kind of value
&quot;figure name&quot; (because it ensures that such variables can always be
initialised -- there is always at least one Figure in the world). Of
course plenty of Inform projects have no artwork at all: so the cover art
figure is unique in that it might refer to nothing. That sounds a little
arbitrary but in fact follows a convention used by the Blorb format for
binding story files with their resources, which in turn follows Infocom
conventions of 1987-89: the cover art always has resource ID number 1,
whether it exists or not. Inform creates figures and sound effects counting
upwards from 1, giving them each unique resource ID numbers, so the first
to be created gets ID number 1: by defining &quot;figure of cover&quot; here, we
can be sure that we are first, so everything works.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Section 7 - Unindexed Standard Rules variables - Unindexed</span>

<span class="plain-syntax">The story title, the story author, the story headline, the story genre</span>
<span class="plain-syntax">and the story description are text variables. [*****]</span>
<span class="plain-syntax">The release number and the story creation year are number variables. [**]</span>
<span class="plain-syntax">The story licence, the story copyright, the story origin URL, and the</span>
<span class="plain-syntax">story rights history are text variables. [****]</span>

<span class="plain-syntax">The release number is usually 1.</span>
<span class="plain-syntax">The story headline is usually "An Interactive Fiction".</span>
<span class="plain-syntax">The story genre is usually "Fiction".</span>

<span class="plain-syntax">The story title variable is defined by Inter as "Story".</span>

<span class="plain-syntax">Section SR2/6b - Unindexed Standard Rules variables - Unindexed (for figures language element only)</span>

<span class="plain-syntax">Figure of cover is the file of cover art ("The cover art.").</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP9" class="paragraph-anchor"></a><b>&#167;9. </b>  And we finish out the set with some &quot;secret&quot; variables used only by the
Standard Rules or by Inform, and which are therefore also unindexed. Their
names are all hyphenated, to reduce the chance of anyone stumbling into
them in a namespace clash.</p>
<p>The first set of three secret variables is used by the predicate calculus
machinery in Inform. This is the code which handles logical sentences such as
&quot;at least six doors are open&quot; or descriptions such as &quot;open doors&quot;, by
reducing them to a logical notation which sometimes makes use of variables.
For instance, &quot;open doors&quot; reduces to something like &quot;all \INWEBMATH(x\INWEBMATH) such that
door(\INWEBMATH(x\INWEBMATH)) and open(\INWEBMATH(x\INWEBMATH))&quot;, with \INWEBMATH(x\INWEBMATH) being a variable. When Inform works with
such logical propositions, it often needs to substitute \INWEBMATH(x=c\INWEBMATH), that is, to
replace \INWEBMATH(x\INWEBMATH) with a given constant \INWEBMATH(c\INWEBMATH). But it can only do this if \INWEBMATH(c\INWEBMATH) is an
Inform 7 value. This is a problem if what it wants is to substitute in
something which is only meaningful at the I6 level: say, it wants to
substitute a value \INWEBMATH(c\INWEBMATH) which will eventually translate to <code>whatever</code>, but
it can't find any I7 value \INWEBMATH(c\INWEBMATH) which will do this.</p>
<p>We solve this problem by constructing some unusual I7 variables whose only
purpose is that Inform can use them in substitutions. They should never be
referred to in I7 source text anywhere else at all, not even elsewhere in
the Standard Rules.</p>
<ul>
<li>
<p>The sentence &quot;The i6-nothing-constant is an object that varies.&quot; is
a rare example of a flat lie in the Standard Rules, as it is the I6 constant
<code>nothing</code> and never varies at all. It exists as a &quot;variable&quot; so that the
substitution \INWEBMATH(x=\INWEBMATH)~<code>nothing</code> can be made.</p>
</li>
<li>
<p>Well, once you start telling lies it's so hard to stop, and it's also a
lie that the &quot;I6-varying-global&quot; translates to <code>nothing</code>. It actually
translates to whatever the Inform machinery for compiling propositions happens
to want at the moment, so it has no permanent meaning at all. (It will
always translate to an I6 global variable storing a value whose I7 kind
is &quot;object&quot;, so the type-checking machinery isn't endangered by this
chicanery. It will in fact never translate to <code>nothing</code>, but we make the
translation sentence below in order to avoid allocating any storage at
run-time for what is in the end only a label.)</p>
</li>
</ul>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Section 8 - Unindexed Standard Rules variables - Unindexed</span>

<span class="plain-syntax">The I6-nothing-constant is an object that varies.</span>
<span class="plain-syntax">The I6-nothing-constant variable is defined by Inter as "nothing".</span>

<span class="plain-syntax">The I6-varying-global is an object that varies.</span>
<span class="plain-syntax">The I6-varying-global variable is defined by Inter as "nothing".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP10" class="paragraph-anchor"></a><b>&#167;10. </b>  The remaining secret variables are:</p>
<ul>
<li>
<p>The &quot;item-pushed-between-rooms&quot; is needed to get the identity of
an object being pushed by a command like PUSH ARMCHAIR NORTH out of I6
and into the action variable &quot;thing gone with&quot; of the going action.</p>
</li>
<li>
<p>The &quot;actor-location&quot; is needed temporarily to store the room in
which the actor of the current action is standing, and it wants to be
an I6 global (rather than, say, a rulebook variable belonging to the
action-processing rulebook) so that Inform can use common code to handle
this alongside <code>noun</code>, <code>second</code> and <code>actor</code> when compiling preambles
to rules.</p>
</li>
<li>
<p>The &quot;parameter-object&quot; is likewise needed in order to compile
preambles to rules in object-based rulebooks.</p>
</li>
</ul>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">The item-pushed-between-rooms is an object that varies.</span>
<span class="plain-syntax">The item-pushed-between-rooms variable is defined by Inter as "move_pushing".</span>

<span class="plain-syntax">The actor-location is an object that varies. [*]</span>
<span class="plain-syntax">The actor-location variable is defined by Inter as "actor_location".</span>

<span class="plain-syntax">The scene being changed is a scene that varies. [*]</span>
<span class="plain-syntax">The scene being changed variable is defined by Inter as "parameter_value".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP11" class="paragraph-anchor"></a><b>&#167;11. Rulebooks.</b>  Whereas Basic Inform equips the language with only a handful of rulebooks
to start out, the Standard Rules are replete with them.</p>
<p>When an interactive fiction project using the Standard Rules starts up,
it does the following:</p>
<ul>
<li>Consider the startup rules.</li>
<li>Repeatedly follow the turn sequence rules until the Inter variable
<code>deadflag</code> is set, which is used to indicate that the game has ended in one
way or another (though not necessarily in &quot;death&quot;).</li>
<li>Follow the shutdown rules.</li>
</ul>
<p>Briefly, the startup phase takes us to the end of the room description
after the banner is printed. The turn sequence covers a complete turn,
and runs through from prompting the player for a command to notifying
them of any change in score which occurred. The shutdown rules then go
from printing the obituary text, through final score, to the question
about quitting or restarting.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Chapter 2 - Rulebooks</span>

<span class="plain-syntax">Section 1 - The Standard Rulebooks</span>

<span class="plain-syntax">Turn sequence rules is a nothing based rulebook.</span>
<span class="plain-syntax">The turn sequence rulebook is accessible to Inter as "TURN_SEQUENCE_RB".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP12" class="paragraph-anchor"></a><b>&#167;12. </b>  Now a set of rulebooks to do with the passage of time.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Scene changing rules is a rulebook.</span>
<span class="plain-syntax">The scene changing rulebook is accessible to Inter as "SCENE_CHANGING_RB".</span>
<span class="plain-syntax">When play begins is a rulebook.</span>
<span class="plain-syntax">The when play begins rulebook is accessible to Inter as "WHEN_PLAY_BEGINS_RB".</span>
<span class="plain-syntax">When play ends is a rulebook.</span>
<span class="plain-syntax">The when play ends rulebook is accessible to Inter as "WHEN_PLAY_ENDS_RB".</span>
<span class="plain-syntax">When scene begins is a scene based rulebook.</span>
<span class="plain-syntax">The when scene begins rulebook is accessible to Inter as "WHEN_SCENE_BEGINS_RB".</span>
<span class="plain-syntax">When scene ends is a scene based rulebook.</span>
<span class="plain-syntax">The when scene ends rulebook is accessible to Inter as "WHEN_SCENE_ENDS_RB".</span>
<span class="plain-syntax">Every turn rules is a rulebook.</span>
<span class="plain-syntax">The every turn rulebook is accessible to Inter as "EVERY_TURN_RB".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP13" class="paragraph-anchor"></a><b>&#167;13. </b>  The action machinery requires some 16 rulebooks to work, though that is
the result of gradual simplification -- in 2006 it required 25, for instance.
The &quot;action-processing&quot; rulebook, like the turn sequence rulebook, is a
master of ceremonies: it belongs to the Standard Rules and is only rarely if
at all referred to by users.</p>
<p>As remarked above, it's something of a historical accident that &quot;actor&quot; is
a rulebook variable belonging to the action-processing rules (and thus in
scope for every rulebook it employs) while &quot;noun&quot; and &quot;second noun&quot; are
global variables (and thus in scope everywhere).</p>
<p>The main action-processing rulebook delegates most of its detailed work to
a subsidiary, the &quot;specific action-processing&quot; rulebook, at the point where
what rulebooks we consult next depends on what the action is (hence &quot;specific&quot;)
-- see below for more on how check/carry out/report rules are filed.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Action-processing rules is a rulebook.</span>
<span class="plain-syntax">The action-processing rulebook is accessible to Inter as "ACTION_PROCESSING_RB".</span>
<span class="plain-syntax">The action-processing rulebook has a person called the actor.</span>
<span class="plain-syntax">Setting action variables is a rulebook.</span>
<span class="plain-syntax">The setting action variables rulebook is accessible to Inter as "SETTING_ACTION_VARIABLES_RB".</span>
<span class="plain-syntax">The specific action-processing rules is a rulebook.</span>
<span class="plain-syntax">The specific action-processing rulebook is accessible to Inter as "SPECIFIC_ACTION_PROCESSING_RB".</span>
<span class="plain-syntax">The specific action-processing rulebook has a truth state called action in world.</span>
<span class="plain-syntax">The specific action-processing rulebook has a truth state called action keeping silent.</span>
<span class="plain-syntax">The specific action-processing rulebook has a rulebook called specific check rulebook.</span>
<span class="plain-syntax">The specific action-processing rulebook has a rulebook called specific carry out rulebook.</span>
<span class="plain-syntax">The specific action-processing rulebook has a rulebook called specific report rulebook.</span>
<span class="plain-syntax">The specific action-processing rulebook has a truth state called within the player's sight.</span>
<span class="plain-syntax">The player's action awareness rules is a rulebook.</span>
<span class="plain-syntax">The player's action awareness rulebook is accessible to Inter as "PLAYERS_ACTION_AWARENESS_RB".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP14" class="paragraph-anchor"></a><b>&#167;14. </b>  The rules on accessibility and visibility, which control whether an action
is physically possible, have named outcomes as a taste of syntactic sugar.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Accessibility rules is a rulebook.</span>
<span class="plain-syntax">The accessibility rulebook is accessible to Inter as "ACCESSIBILITY_RB".</span>
<span class="plain-syntax">Reaching inside rules is an object-based rulebook.</span>
<span class="plain-syntax">The reaching inside rulebook is accessible to Inter as "REACHING_INSIDE_RB".</span>
<span class="plain-syntax">Reaching inside rules have outcomes allow access (success) and deny access (failure).</span>
<span class="plain-syntax">Reaching outside rules is an object-based rulebook.</span>
<span class="plain-syntax">The reaching outside rulebook is accessible to Inter as "REACHING_OUTSIDE_RB".</span>
<span class="plain-syntax">Reaching outside rules have outcomes allow access (success) and deny access (failure).</span>
<span class="plain-syntax">Visibility rules is a rulebook.</span>
<span class="plain-syntax">The visibility rulebook is accessible to Inter as "VISIBLE_RB".</span>
<span class="plain-syntax">Visibility rules have outcomes there is sufficient light (failure) and there is</span>
<span class="plain-syntax">insufficient light (success).</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP15" class="paragraph-anchor"></a><b>&#167;15. </b>  Two rulebooks govern the processing of asking other people to carry out actions:</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Persuasion rules is a rulebook.</span>
<span class="plain-syntax">The persuasion rulebook is accessible to Inter as "PERSUADE_RB".</span>
<span class="plain-syntax">Persuasion rules have outcomes persuasion succeeds (success) and persuasion fails (failure).</span>
<span class="plain-syntax">Unsuccessful attempt by is a rulebook.</span>
<span class="plain-syntax">The unsuccessful attempt by rulebook is accessible to Inter as "UNSUCCESSFUL_ATTEMPT_RB".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP16" class="paragraph-anchor"></a><b>&#167;16. </b>  Next, the six classic rulebooks best known to users of Inform. It's
perhaps an unfortunate point of the design that there are so many as six:
that seems rather a lot of stages to go through, and indeed means that there
is sometimes some ambiguity about which rulebook to use if one wants to
achieve a given effect. There are really two reasons why things are done
this way:</p>
<ul>
<li>
<p>To try to encourage a distinction between:</p>
<ul>
<li>
<p>the general implementation of an action, made with carry out, check
and report rules -- say, a &quot;photographing&quot; action which could be used in
any situation and could be copied and pasted into another project; and</p>
<ul>
<li>the contingent rules applying in particular situations in play, made
with before, instead and after rules, such as that custodians at the
Metropolitan Museum of Art forbid flash photography.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>To improve the efficiency of action-processing by forcing control to
run only through those carry out, check and report rules which can possibly
be relevant to the current action. Whereas all before, instead and after
rules are all piled up together in their own rulebooks, check, carry out
and report rules are divided up into specialised rulebooks tied to the
particular action in progress. Thus on a taking action, the six stages
followed are before, instead, check taking, carry out taking, after and
report taking.</p>
</li>
</ul>
<p>During play, then, the three rulebooks &quot;check&quot;, &quot;after&quot; and &quot;report&quot;
are completely empty. This is the result of a reform in April 2007 which
wasn't altogether popular. Before then, Inform rather cleverly filed rules like
&quot;Check doing something with the haddock&quot; in the generic &quot;check&quot;
rulebook and ran this rulebook as part of the action processing sequence.
But this clearly broke principle (i) above, and meant that the six-stage
process -- already quite complicated enough -- was actually a nine-stage
process only pretending, by deceitful syntax, to be a six-stage one. Check
rules sometimes appeared to be filed in the wrong order, breaking the
ordinary precedence conventions, and this was not due to a bug but because
they were only pretending all to be in the same rulebook. Still more clever
indexing and rule-ordering tricks ameliorated this a little, but in the end
it was just a bad design: withdrawing the ability to make check, carry out
and report rules apply to multiple actions resulted in much cleaner code,
and also a clearer conceptual definition of what these rulebooks were for.
(But users still didn't like the change: actual functionality was
withdrawn.)</p>
<p>So if they are always empty and never used, why are the three rulebooks
called simply &quot;check&quot;, &quot;after&quot; and &quot;report&quot; created in the first
place? The answer is that this is a convenience for parsing rule preambles
in Inform: it provides a temporary home for such rules before they are divided up
into their specific rulebooks, and it also makes it easier for Inform to detect
and give a helpful Problem message in response to rules like &quot;Check taking
or dropping the perch&quot; which can't be filed anywhere in our scheme, and so
have to be forbidden.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Before rules is a rulebook.</span>
<span class="plain-syntax">The before rulebook is accessible to Inter as "BEFORE_RB".</span>
<span class="plain-syntax">Instead rules is a rulebook.</span>
<span class="plain-syntax">The instead rulebook is accessible to Inter as "INSTEAD_RB".</span>
<span class="plain-syntax">Check rules is a rulebook.</span>
<span class="plain-syntax">The check rulebook is accessible to Inter as "CHECK_RB".</span>
<span class="plain-syntax">Carry out rules is a rulebook.</span>
<span class="plain-syntax">The carry out rulebook is accessible to Inter as "CARRY_OUT_RB".</span>
<span class="plain-syntax">After rules is a rulebook.</span>
<span class="plain-syntax">The after rulebook is accessible to Inter as "AFTER_RB".</span>
<span class="plain-syntax">Report rules is a rulebook.</span>
<span class="plain-syntax">The report rulebook is accessible to Inter as "REPORT_RB".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP17" class="paragraph-anchor"></a><b>&#167;17. </b>  The next rulebook in this roundup is one used for parsing ambiguous
commands during play. This looks like the job of an activity rather than a
rulebook, but (i) we want information in the form of a nicely-named five point
scale of responses, rather than wanting something to be done, and (ii) it
doesn't really make any sense to split that question into a before, for and
after stage. So this is a named rulebook instead.</p>
<p>&quot;Does the player mean&quot; is essentially a front end for the I6 parser's
<code>ChooseObjects</code> entry point, which relies on numerical scores to assess the
likelihood of possible choices. To facilitate that, the I7 compiler recognises
these five outcome names and translates them into the Inter constants
<code>RBNO4_OUTCOME</code>, <code>RBNO3_OUTCOME</code>, ..., <code>RBNO0_OUTCOME</code> respectively. So don't
change the names of these outcomes.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">The does the player mean rules is a rulebook.</span>
<span class="plain-syntax">The does the player mean rulebook is accessible to Inter as "DOES_THE_PLAYER_MEAN_RB".</span>
<span class="plain-syntax">The does the player mean rules have outcomes it is very likely, it is likely, it is possible,</span>
<span class="plain-syntax">it is unlikely and it is very unlikely.</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP18" class="paragraph-anchor"></a><b>&#167;18. </b>  The following rulebook was added at the (implied) suggestion of John
Clemens, whose Consolidated Multiple Actions extension made use of
something similar.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">The multiple action processing rules is a rulebook.</span>
<span class="plain-syntax">The multiple action processing rulebook is accessible to Inter as "MULTIPLE_ACTION_PROCESSING_RB".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP19" class="paragraph-anchor"></a><b>&#167;19. </b>  And that's it: all of the named rulebooks now exist. There will, of
course, be hundreds more rulebooks soon, created automatically as activities
and actions are created -- when we create the &quot;dropping&quot; action, for
instance, we also create the &quot;check dropping&quot;, &quot;carry out dropping&quot; and
&quot;report dropping&quot; rulebooks -- but there are no more stand-alone rulebooks.</p>
</div>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP20" class="paragraph-anchor"></a><b>&#167;20. Rules.</b>  At run-time, the value of a rule is the (packed) address of an I6 routine.
In the case of rules created in I7 source text, the body of the rule
definition is compiled by Inform to a new I6 routine which carries it out.
But there are also primitive rules which are implemented in the template
I6 layer, and these need no I7 source text definitions: instead we simply
tell Inform the name of the I6 routine which will be handling this rule, and
that it need not bother to create one for itself.</p>
<p>An example of this is provided by the first rule we shall create: the
&quot;little-used do nothing rule&quot;. This is aptly named on both counts. We
never follow it, we never put it into any rulebook. It exists only so that
variables and properties with the kind of value &quot;rule&quot; can be initialised
automatically to a safely neutral default value. It makes no decision.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Section 2 - The Standard Rules</span>

<span class="plain-syntax">The little-used do nothing rule is defined by Inter as "LITTLE_USED_DO_NOTHING_R".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP21" class="paragraph-anchor"></a><b>&#167;21. Startup.</b>  These startup rules prepare the various world model specific systems.</p>
<ul>
<li>
<p>The printing of three blank lines at the start of play is traditional: on early
Z-machine interpreters such as InfoTaskForce and Zip it was a necessity because
of the way they buffered output. On modern windowed ones it still helps to
space the opening text better.</p>
</li>
<li>
<p>The &quot;update chronological records rule&quot; is described in further detail
below, since it appears both here and also in the turn sequence rulebook.
Here it's providing us with a baseline of initial truths from which we can
later assess conditions such as &quot;the marble door has been open&quot;. A subtle
and questionable point of the design is that this rule is placed at a time
when the object representing the player is not present in the model world.
This is done to avoid regarding the initial situation as one of the turns
for purposes of a rule preamble like &quot;... when the player has been in the
Dining Room for three turns&quot;. It's as if the player teleports into an
already-existing world, like some Star Trek crewman, just in time for the
first command.</p>
</li>
<li>
<p>The &quot;position player in model world rule&quot; completes the initial
construction of the spatial model world.</p>
</li>
<li>
<p>The &quot;start in the correct scenes rule&quot; ensures that we start out
in the correct scenes. (This can't wait, because it's just conceivable
that somebody has written a rule with a preamble like &quot;When play
begins during the Hunting Season...&quot;: it's also where the scene
Entire Game begins.) That completes the necessary preliminaries before
ordinary I7 rules can be run.</p>
</li>
</ul>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">The initial whitespace rule is listed in the after starting the virtual machine rules.</span>
<span class="plain-syntax">The initial whitespace rule translates into Inter as "INITIAL_WHITESPACE_R".</span>

<span class="plain-syntax">The update chronological records rule is listed in the after starting the virtual machine rules.</span>
<span class="plain-syntax">The update chronological records rule translates into Inter as "UPDATE_CHRONOLOGICAL_RECORDS_R".</span>

<span class="plain-syntax">The position player in model world rule is listed in the after starting the virtual machine rules.</span>
<span class="plain-syntax">The position player in model world rule translates into Inter as "POSITION_PLAYER_IN_MODEL_R".</span>

<span class="plain-syntax">The start in the correct scenes rule is listed in the after starting the virtual machine rules.</span>
<span class="plain-syntax">This is the start in the correct scenes rule:</span>
<span class="plain-syntax">    follow the scene changing rules.</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP22" class="paragraph-anchor"></a><b>&#167;22. </b>  The remaining rules, though, are fair game for alteration, and as if to
prove the point they are all written in standard I7 source text. Note that
the baseline score is set only after the when play begins rulebook has
finished, because games starting with a non-zero score normally do this
by changing the score in a when play begins rule: and we don't want such
a change to be notified to the player as if it has happened through some
action.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Startup rule (this is the when play begins stage rule):</span>
<span class="plain-syntax">    follow the when play begins rulebook.</span>

<span class="plain-syntax">Startup rule (this is the fix baseline scoring rule):</span>
<span class="plain-syntax">    now the last notified score is the score.</span>

<span class="plain-syntax">Startup rule (this is the display banner rule):</span>
<span class="plain-syntax">    say "[banner text]".</span>

<span class="plain-syntax">Startup rule (this is the initial room description rule):</span>
<span class="plain-syntax">    surreptitiously reckon darkness;</span>
<span class="plain-syntax">    try looking.</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP23" class="paragraph-anchor"></a><b>&#167;23. The turn sequence.</b>  In each turn, a command is read and parsed from the keyboard, and any
action(s) that requested is or are processed. (And may in turn cause
other actions, which must also be processed.) There is then a fair
amount of business needed to end one turn and get ready for another.</p>
<p>The turn sequences rulebook terminates early if <code>deadflag</code> becomes set at
any point, so the last turn of play will be incomplete. Besides that
consideration, it can also end early if the command for the turn was
for an out-of-world action such as saving the game: in such cases, the
&quot;generate action rule&quot; stops the rulebook once the action has been
fully processed. All the same, play basically consists of running down
this list of rules over and over again.</p>
</div>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP24" class="paragraph-anchor"></a><b>&#167;24. </b>  The &quot;first&quot; rules in the turn sequence cover us up to the end of the
events which take place in the model world during this turn's action(s).</p>
<ul>
<li>
<p>The &quot;parse command rule&quot; prints up the prompt, reads a command from
the keyboard, parses it into dictionary words, deals with niceties such as
UNDO or OOPS, and then runs it through the traditional I6 parser to turn
it into a request for an action or list of actions. But see note below.</p>
</li>
<li>
<p>The &quot;mentioned&quot; property records whether something's name has been
printed since the last command.</p>
</li>
<li>
<p>The &quot;generate action rule&quot; then either sends a single action to the
action-processing rules, or else runs through the list, printing the noun
up with a colon each time and then sending the action to the action-processing
rules. But see note below.</p>
</li>
<li>
<p>We then run the scene changing rulebook, because people often write
every turn rules which are predicated on particular scenes (&quot;Every turn
during the Grand Waltz: ...&quot;), and such rules will fail if we haven't kept
up with possible scene changes arising from something done in the action(s)
just completed.</p>
</li>
<li>
<p>The &quot;every turn stage rule&quot; follows the every turn rulebook. This
earns its place among the &quot;first&quot; rules in order for it to have priority
over all the other book-keeping rules at the end of a turn -- including any
which the user, or an extension included by the user, chooses to add to the
turn sequence rules.</p>
</li>
</ul>
<p>An unusual point here is that the &quot;parse command rule&quot; and the
&quot;generate action rule&quot; are written such that they do nothing unless
the turn sequence rulebook is being followed at the top level (by <code>Main</code>,
that is). This prevents them from being used recursively, which would not
work properly, and enables a popular trick from the time before the 2008
reform to keep working: we can simulate six turns going by in which the
player does nothing by running &quot;follow the turn sequence rules&quot; six
times in a row. Everything happens exactly as it should -- the turn count,
the time of day, timed events, and so on -- except that no commands are
read and no consequent actions generated.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">A first turn sequence rule (this is the every turn stage rule):</span>
<span class="plain-syntax">    follow the every turn rules. [5th.]</span>
<span class="plain-syntax">A first turn sequence rule (this is the early scene changing stage rule):</span>
<span class="plain-syntax">    follow the scene changing rules. [4th.]</span>
<span class="plain-syntax">The generate action rule is listed first in the turn sequence rulebook. [3rd.]</span>
<span class="plain-syntax">This is the declare everything initially unmentioned rule:</span>
<span class="plain-syntax">    repeat with item running through things:</span>
<span class="plain-syntax">        now the item is not mentioned.</span>
<span class="plain-syntax">The declare everything initially unmentioned rule is listed first in the turn sequence rulebook. [2nd.]</span>
<span class="plain-syntax">The parse command rule is listed first in the turn sequence rulebook. [1st.]</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP25" class="paragraph-anchor"></a><b>&#167;25. </b>  Three miscellaneous things then happen, all implemented by primitives
in the template I6 layer:</p>
<ul>
<li>
<p>The &quot;timed events rule&quot; is the one which causes other rules, keyed
to particular times of day, to fire.</p>
</li>
<li>
<p>The &quot;advance time rule&quot; then causes the &quot;time of day&quot; global variable
to advance by the duration of a single turn, which by default is 1 minute.</p>
</li>
<li>
<p>The &quot;update chronological records rule&quot; tells the chronology machine
that a slice of time has been completed. Inform can only decide past tense
conditions like &quot;the black door has been open&quot; by continuously measuring
the present to see if the black door is open now, and making a note for
future reference if it is. But of course it's impossible for any computer
to continuously do anything, and besides, Inform has other calls on it.
What in fact happens is that Inform performs these measurements at &quot;chronology
points&quot;, which are strategic moments during play, and this is one of them.</p>
</li>
</ul>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">The timed events rule is listed in the turn sequence rulebook.</span>
<span class="plain-syntax">The advance time rule is listed in the turn sequence rulebook.</span>
<span class="plain-syntax">The update chronological records rule is listed in the turn sequence rulebook.</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP26" class="paragraph-anchor"></a><b>&#167;26. </b>  We now come to the rules anchored at the end, using &quot;last&quot;. This part of
the rulebook is reserved for book-keeping which has to happen positively
at the end of the turn.</p>
<ul>
<li>
<p>First, we check for scene changes again. We did this only a short while
ago, but scene changes might well have arisen as a result of rules which
fired during the every turn rulebook, or from timed events, or in some other
way, and it's important to start the next turn in the correct scene -- so we
check again to make sure.</p>
</li>
<li>
<p>Then we run the &quot;adjust light rule&quot;. Keeping track of light and darkness
is quite difficult, and potentially also quite slow: it's not unlike a sort
of discretised version of ray-tracing, with many light sources and barriers
to think about (some transparent, some opaque). So we do this as little as
possible: once per turn we calculate whether the player is in light or not,
and act accordingly if so.</p>
</li>
<li>
<p>The &quot;note object acquisitions rule&quot; does two things:</p>
<ul>
<li>Gives the &quot;handled&quot; property to everything carried or worn by the player.
<ul>
<li>Changes the current player's holdall in use, if necessary. (That's to
say: if the player has dropped their previous player's holdall, we try to find a
new one to use from their remaining possessions.)</li>
</ul>
</li>
</ul>
</li>
<li>
<p>The &quot;notify score changes rule&quot; tells the player if the score has changed
during the turn, or rather, since the last time either this rule or the startup
&quot;fix baseline scoring rule&quot; ran. (If the score were to change in the course
of an out-of-world action, it would be notified a turn late, but of course
out-of-world actions are not supposed to do that sort of thing.)</p>
</li>
</ul>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">A last turn sequence rule (this is the late scene changing stage rule):</span>
<span class="plain-syntax">    follow the scene changing rules. [3rd from last.]</span>
<span class="plain-syntax">The adjust light rule is listed last in the turn sequence rulebook. [2nd from last.]</span>
<span class="plain-syntax">The note object acquisitions rule is listed last in the turn sequence rulebook. [Penultimate.]</span>
<span class="plain-syntax">The notify score changes rule is listed last in the turn sequence rulebook. [Last.]</span>

<span class="plain-syntax">This is the notify score changes rule:</span>
<span class="plain-syntax">    if the score is not the last notified score:</span>
<span class="plain-syntax">        issue score notification message;</span>
<span class="plain-syntax">        now the last notified score is the score;</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP27" class="paragraph-anchor"></a><b>&#167;27. </b>  That's it, but we need to map these I7 rule names onto the names of their
I6 primitives in the template layer.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">The adjust light rule is defined by Inter as "ADJUST_LIGHT_R" with</span>
<span class="plain-syntax">    "[It] [are] [if story tense is present tense]now [end if]pitch dark in [here]!" (A).</span>
<span class="plain-syntax">The advance time rule is defined by Inter as "ADVANCE_TIME_R".</span>
<span class="plain-syntax">The generate action rule is defined by Inter as "GENERATE_ACTION_R" with</span>
<span class="plain-syntax">    "(considering the first sixteen objects only)[command clarification break]" (A),</span>
<span class="plain-syntax">    "Nothing to do!" (B).</span>

<span class="plain-syntax">The note object acquisitions rule is defined by Inter as "NOTE_OBJECT_ACQUISITIONS_R".</span>
<span class="plain-syntax">The parse command rule is defined by Inter as "PARSE_COMMAND_R".</span>
<span class="plain-syntax">The timed events rule is defined by Inter as "TIMED_EVENTS_R".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP28" class="paragraph-anchor"></a><b>&#167;28. Shutdown.</b>  Goodbye is not the hardest word to say, but it does involve a little bit of
work. It might not actually be goodbye, for one thing: if this rulebook ends
in success, then we go back to repeating the turn sequence rulebook just as
if nothing had happened.</p>
<ul>
<li>
<p>The &quot;when play ends stage rule&quot; follows the rulebook of the same name.</p>
</li>
<li>
<p>The &quot;resurrect player if asked rule&quot; does nothing unless one of the
&quot;when play ends&quot; rules ran the &quot;resume the game&quot; phrase, in which case
it stops the rulebook with success (see above).</p>
</li>
<li>
<p>The &quot;print player's obituary rule&quot; carries out the activity of nearly
the same name (see below).</p>
</li>
<li>
<p>The &quot;ask the final question rule&quot; asks the celebrated &quot;Would you like
to RESTART, RESTORE a saved game or QUIT?&quot; question, and acts on the
consequences. It can also cause an UNDO, and on a victorious ending may
carry out the &quot;amusing a victorious player&quot; activity (see below). The rule
only actually ends in the event of a QUIT: an UNDO, RESTART or RESTORE is
performed at the hardware level by the virtual machine and destroys the
current execution context entirely.</p>
</li>
</ul>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">The when play ends stage rule is listed first in the shutdown rulebook.</span>
<span class="plain-syntax">The resurrect player if asked rule is listed last in the shutdown rulebook.</span>
<span class="plain-syntax">The print player's obituary rule is listed last in the shutdown rulebook.</span>
<span class="plain-syntax">The ask the final question rule is listed last in the shutdown rulebook.</span>

<span class="plain-syntax">This is the when play ends stage rule: follow the when play ends rulebook.</span>
<span class="plain-syntax">This is the print player's obituary rule:</span>
<span class="plain-syntax">    carry out the printing the player's obituary activity.</span>

<span class="plain-syntax">The resurrect player if asked rule is defined by Inter as "RESURRECT_PLAYER_IF_ASKED_R".</span>
<span class="plain-syntax">The ask the final question rule is defined by Inter as "ASK_FINAL_QUESTION_R".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP29" class="paragraph-anchor"></a><b>&#167;29. Scene changing.</b>  Scene changing is handled by a routine called <code>DetectSceneChange</code> which is
compiled directly by Inform: this is so primitive that it can't even be handled
at the template layer. The rulebook is all a little elaborate given that
it contains only one rule, but it's possible to imagine extensions which
need to do book-keeping similar to scene changing and which want to make
use of this opportunity.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">The scene change machinery rule is listed last in the scene changing rulebook.</span>

<span class="plain-syntax">The scene change machinery rule is defined by Inter as "SCENE_CHANGE_MACHINERY_R".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP30" class="paragraph-anchor"></a><b>&#167;30. </b>  We couldn't do this earlier (because creating a scene automatically generates
two rulebooks, and that would have thrown the rulebook numbering), so let's
take this opportunity to define the &quot;Entire Game&quot; scene:</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Section 3 - The Entire Game scene</span>

<span class="plain-syntax">The Entire Game is a scene.</span>
<span class="plain-syntax">The Entire Game begins when the story has not ended.</span>
<span class="plain-syntax">The Entire Game ends when the story has ended.</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP31" class="paragraph-anchor"></a><b>&#167;31. Action-processing.</b>  Action-processing happens on two levels: an upper level, handled by the main
&quot;action-processing&quot; rulebook, and a lower level, &quot;specific action-processing&quot;.
This division clearly complicates matters, so why do we do it? It turns out be
convenient for several reasons:</p>
<ul>
<li>
<p>Out-of-world actions like &quot;saving the game&quot; need to run through the
lower level, or they won't do anything at all, but must not run through the
upper level, or in-world rules (before or instead rules, for instance) might
prevent them from happening.</p>
</li>
<li>
<p>Requested actions such as generated by a command like &quot;CLARK, BLOW WHISTLE&quot;
have the reverse behaviour, being handled at the upper level but not the lower.
(If Clark should agree, a definite non-request action &quot;Clark blowing the whistle&quot;
is generated afresh: that one does indeed get to the lower level, but the original
request action doesn't.)</p>
</li>
<li>
<p>Specific action-processing has a rather complicated range of outcomes:
it must succeed or fail, according to whether the action either reaches the
carry out rules or is converted into another action which does, but also
ensure that in the event of failure, the exact rule causing the failure is
recorded in the &quot;reason the action failed&quot; variable.</p>
</li>
<li>
<p>The specific action-processing stage is where we have to split consideration
into action-specific rulebooks (like &quot;check taking&quot;) rather than general ones
(like &quot;instead&quot;). To get this right, we want to use some rulebook variables,
and these need to be set at exactly the correct moment. It's tricky to
arrange for that in the middle of a big rulebook, but easy to do so at the
beginning, so we want the start of the SA-P stage to happen at the start of
a rulebook.</p>
</li>
</ul>
<p>This does mean that an attempt by the user to move the before stage to just
after the check stage (say) will fail -- the before and check stages happen
in different rulebooks, so no amount of rearranging will do this.</p>
</div>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP32" class="paragraph-anchor"></a><b>&#167;32. </b>  The upper level of action-processing consists of seeing whether the actor's
current situation forbids the action from being tried: does anybody or
anything intervene to stop it? Are there are any basic reasons of physical
realism why nobody could possibly try it? Does it require somebody else
to cooperate who in fact chooses not to?</p>
<p>Doctrinally, the before stage must see actions before anything else can
happen. (It needs the absolute freedom to start fresh actions and dispose
of the one originally intended, sure in the knowledge that no other rules
have been there first.) So before-ish material is anchored at the &quot;first&quot;
end of the rulebook.</p>
<p>The other book-end on the shelf is provided by the instead stage, which
doctrinally happens only when the action is now thought to be physically
reasonable. So this is anchored at the &quot;last&quot; end. (In fact it is followed
by several more rules also anchored there, but this is essentially just
the clockwork machinery showing through: they aren't realism checks.)</p>
<p>Miscellaneous general rules to do with physical realism are placed between
the two book-ends, then, and this is where any newly created action-processing
rules created by the user or by extensions will go.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Section 4 - Action processing</span>

<span class="plain-syntax">The before stage rule is listed first in the action-processing rules. [3rd.]</span>
<span class="plain-syntax">The set pronouns from items from multiple object lists rule is listed first in the</span>
<span class="plain-syntax">    action-processing rules. [2nd.]</span>
<span class="plain-syntax">The announce items from multiple object lists rule is listed first in the</span>
<span class="plain-syntax">    action-processing rules. [1st.]</span>
<span class="plain-syntax">The basic visibility rule is listed in the action-processing rules.</span>
<span class="plain-syntax">The basic tangibility rule is listed in the action-processing rules.</span>
<span class="plain-syntax">The basic accessibility rule is listed in the action-processing rules.</span>
<span class="plain-syntax">The carrying requirements rule is listed in the action-processing rules.</span>
<span class="plain-syntax">The instead stage rule is listed last in the action-processing rules. [4th from last.]</span>
<span class="plain-syntax">The requested actions require persuasion rule is listed last in the action-processing rules.</span>
<span class="plain-syntax">The carry out requested actions rule is listed last in the action-processing rules.</span>
<span class="plain-syntax">The descend to specific action-processing rule is listed last in the action-processing rules.</span>
<span class="plain-syntax">The end action-processing in success rule is listed last in the action-processing rules. [Last.]</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP33" class="paragraph-anchor"></a><b>&#167;33. </b>  As we shall see, most of these rules are primitives implemented by the
template I6 layer, but five are very straightforward.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">This is the set pronouns from items from multiple object lists rule:</span>
<span class="plain-syntax">    if the current item from the multiple object list is not nothing,</span>
<span class="plain-syntax">        set pronouns from the current item from the multiple object list.</span>

<span class="plain-syntax">This is the announce items from multiple object lists rule:</span>
<span class="plain-syntax">    if the current item from the multiple object list is not nothing,</span>
<span class="plain-syntax">        say "[current item from the multiple object list]: [run paragraph on]" (A).</span>

<span class="plain-syntax">This is the before stage rule:</span>
<span class="plain-syntax">    abide by dialogue before action choices;</span>
<span class="plain-syntax">    abide by the before rules.</span>
<span class="plain-syntax">This is the instead stage rule:</span>
<span class="plain-syntax">    abide by dialogue instead action choices;</span>
<span class="plain-syntax">    abide by the instead rules.</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP34" class="paragraph-anchor"></a><b>&#167;34. </b>  The final rule in the rulebook always succeeds: this ensures that
action-processing always makes a decision. (I7's doctrine is that an
action &quot;succeeds&quot; if and only if its carry-out stage is reached, so
any action getting right to the end of this rulebook must have
succeeded.)</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">This is the end action-processing in success rule: rule succeeds.</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP35" class="paragraph-anchor"></a><b>&#167;35. </b>  The action-processing rulebook contains six primitives:</p>
<ul>
<li>
<p>The &quot;basic visibility rule&quot; checks the action to see if it requires
light, and if so, and if the actor is the player and in darkness, asks
the visibility rules (see below) whether the lack of light should stop
the action. (It would be cleaner to apply this rule to all actors, but we
would need much more extensive light calculations to do this.)</p>
</li>
<li>
<p>The &quot;basic accessibility rule&quot; checks the action to see if it requires
the noun to be touchable, and if so, asks the accessibility rulebook to
adjudicate (see below); then repeats the process for the second noun.</p>
</li>
<li>
<p>The &quot;carrying requirements rule&quot; checks the action to see if it requires
the noun to be carried. If so, but the noun is not carried, it generates an
implicit taking action (in effect, &quot;try silently taking \INWEBMATH(N\INWEBMATH)&quot;); and if that
fails, then the rulebook is halted in failure. The process is then repeated
for the second noun.</p>
</li>
<li>
<p>If the action is one where the player requests somebody else to do
something, the &quot;requested actions require persuasion rule&quot; asks the
persuasion rulebook for permission.</p>
</li>
<li>
<p>If the action is one where the player requests somebody else to do
something, the &quot;carry out requested actions rule&quot; starts a new action by
the person asked, and looks at the result: if it failed, the &quot;unsuccessful
attempt by&quot; rulebook is run to tell the player what has (not) happened.
(If that does nothing, a bland message is printed.) In all cases, the
original action of requesting is ended in success: a success because,
whatever happened, the request succeeded in making the actor try to do
something.</p>
</li>
<li>
<p>The &quot;descend to specific action-processing rule&quot; really only runs the
specific action-processing rulebook, but it's implemented as a primitive in
the template I6 layer because it must also find out which are the
specific check, carry out and report rulebooks for the current action (for
instance, &quot;check taking&quot; is the specific check rulebook for the
&quot;taking&quot; action -- which seems obvious from the names: but at run-time,
the names aren't so visible).</p>
</li>
</ul>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">This is the basic tangibility rule:</span>
<span class="plain-syntax">    unless the action makes a request:</span>
<span class="plain-syntax">        if action requires a touchable noun and the noun is not a thing:</span>
<span class="plain-syntax">            if an actor listening to a room or an actor smelling a room, continue the action;</span>
<span class="plain-syntax">            if the actor is the player, say "You must name something more substantial than [the noun]." (A);</span>
<span class="plain-syntax">            now the reason the action failed is the basic tangibility rule;</span>
<span class="plain-syntax">            rule fails;</span>
<span class="plain-syntax">        if action requires a touchable second noun and the second noun is not a thing:</span>
<span class="plain-syntax">            if the actor is the player, say "You must name something more substantial than [the second noun]." (B);</span>
<span class="plain-syntax">            now the reason the action failed is the basic tangibility rule;</span>
<span class="plain-syntax">            rule fails;</span>

<span class="plain-syntax">The basic accessibility rule is defined by Inter as "BASIC_ACCESSIBILITY_R" with</span>
<span class="plain-syntax">    "You must name something more substantial." (A).</span>
<span class="plain-syntax">The basic visibility rule is defined by Inter as "BASIC_VISIBILITY_R" with</span>
<span class="plain-syntax">    "[It] [are] pitch dark, and [we] [can't see] a thing." (A).</span>
<span class="plain-syntax">The carrying requirements rule is defined by Inter as "CARRYING_REQUIREMENTS_R".</span>
<span class="plain-syntax">The requested actions require persuasion rule is defined by Inter as</span>
<span class="plain-syntax">    "REQUESTED_ACTIONS_REQUIRE_R" with</span>
<span class="plain-syntax">     "[The noun] [have] better things to do." (A).</span>
<span class="plain-syntax">The carry out requested actions rule is defined by Inter as</span>
<span class="plain-syntax">    "CARRY_OUT_REQUESTED_ACTIONS_R" with</span>
<span class="plain-syntax">    "[The noun] [are] unable to do that." (A).</span>
<span class="plain-syntax">The descend to specific action-processing rule is defined by Inter as</span>
<span class="plain-syntax">"DESCEND_TO_SPECIFIC_ACTION_R".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP36" class="paragraph-anchor"></a><b>&#167;36. Specific action-processing.</b>  And now we descend to the lower level, which is much easier to understand.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">The work out details of specific action rule is listed first in the specific</span>
<span class="plain-syntax">action-processing rules.</span>

<span class="plain-syntax">A specific action-processing rule</span>
<span class="plain-syntax">    (this is the investigate player's awareness before action rule):</span>
<span class="plain-syntax">    follow the player's action awareness rules;</span>
<span class="plain-syntax">    if rule succeeded, now within the player's sight is true;</span>
<span class="plain-syntax">    otherwise now within the player's sight is false.</span>

<span class="plain-syntax">A specific action-processing rule (this is the check stage rule):</span>
<span class="plain-syntax">    anonymously abide by the specific check rulebook.</span>

<span class="plain-syntax">A specific action-processing rule (this is the carry out stage rule):</span>
<span class="plain-syntax">    follow the specific carry out rulebook.</span>

<span class="plain-syntax">A specific action-processing rule (this is the after stage rule):</span>
<span class="plain-syntax">    if action in world is true:</span>
<span class="plain-syntax">        abide by the after rules.</span>

<span class="plain-syntax">A specific action-processing rule</span>
<span class="plain-syntax">    (this is the investigate player's awareness after action rule):</span>
<span class="plain-syntax">    if within the player's sight is false:</span>
<span class="plain-syntax">        follow the player's action awareness rules;</span>
<span class="plain-syntax">        if rule succeeded, now within the player's sight is true;</span>

<span class="plain-syntax">A specific action-processing rule (this is the report stage rule):</span>
<span class="plain-syntax">    if within the player's sight is true and action keeping silent is false,</span>
<span class="plain-syntax">        follow the specific report rulebook;</span>

<span class="plain-syntax">The last specific action-processing rule (this is the default action success rule):</span>
<span class="plain-syntax">    rule succeeds.</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP37" class="paragraph-anchor"></a><b>&#167;37. </b>  The unusual use of &quot;anonymously abide by&quot; above is a form of &quot;abide
by&quot; which may be worth explaining. Suppose rule \INWEBMATH(X\INWEBMATH) consists of an
instruction to abide by rulebook \INWEBMATH(Y\INWEBMATH), and suppose that \INWEBMATH(Y\INWEBMATH) in fact fails
when it reaches \INWEBMATH(Y_k\INWEBMATH). If the ordinary &quot;abide by&quot; is used then the action
will be deemed to have failed at rule \INWEBMATH(X\INWEBMATH), but if &quot;anonymously abide by&quot;
is used then it will be deemed to have failed at \INWEBMATH(Y_k\INWEBMATH). (Thus \INWEBMATH(X\INWEBMATH) remains
anonymous: it can never be the culprit.) We only use this at the check
stage, because the carry out, report and after stages are not allowed to
fail the action. (The after stage is allowed to end it, but not in
failure.)</p>
</div>
<p class="commentary firstcommentary"><a id="SP38" class="paragraph-anchor"></a><b>&#167;38. </b> </p>

<blockquote>
    <p>This is the sixth sense rule: if the player is not the actor, say "You sense that [the actor] is up to something."</p>
</blockquote>

<blockquote>
    <p>The sixth sense rule is listed before the carry out stage rule in the specific action-processing rules.</p>
</blockquote>

<div class="lsmarkdown">
<p>The specific action-processing rulebook is probably more fruitful than the
main one if we want to modify what happens. For instance:</p>
</div>
<div class="lsmarkdown">
<p>...produces the message at a time when the action is definitely possible and
will succeed, but before anything has been done.</p>
</div>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP39" class="paragraph-anchor"></a><b>&#167;39. </b>  The only rule not spelled out was the primitive &quot;work out details of
specific action rule&quot;, which initialises the rulebook variables so that
they record the action's specific check, carry out and report rulebooks,
and whether or not it is in world.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">The work out details of specific action rule is defined by Inter as</span>
<span class="plain-syntax">"WORK_OUT_DETAILS_OF_SPECIFIC_R".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP40" class="paragraph-anchor"></a><b>&#167;40. Player's action awareness.</b>  This rulebook decides whether or not an action by somebody should be routinely
reported to the player: are they aware of it having taken place? If the rulebook
positively succeeds then they are, and otherwise not.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">A player's action awareness rule</span>
<span class="plain-syntax">    (this is the player aware of their own actions rule):</span>
<span class="plain-syntax">    if the player is the actor, rule succeeds.</span>
<span class="plain-syntax">A player's action awareness rule</span>
<span class="plain-syntax">    (this is the player aware of actions by visible actors rule):</span>
<span class="plain-syntax">    if the player is not the actor and the player can see the actor, rule succeeds.</span>
<span class="plain-syntax">A player's action awareness rule</span>
<span class="plain-syntax">    (this is the player aware of actions on visible nouns rule):</span>
<span class="plain-syntax">    if the noun is a thing and the player can see the noun, rule succeeds.</span>
<span class="plain-syntax">A player's action awareness rule</span>
<span class="plain-syntax">    (this is the player aware of actions on visible second nouns rule):</span>
<span class="plain-syntax">    if the second noun is a thing and the player can see the second noun, rule succeeds.</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP41" class="paragraph-anchor"></a><b>&#167;41. Accessibility.</b>  The &quot;accessibility&quot; rulebook is not very visible to users: it's another
behind-the-scenes rulebook for managing the decision as to whether the actor
can touch any items which the intended action requires them to be able to
reach.</p>
<p>In its default configuration, it contains only the &quot;access through barriers&quot;
rule. This in all circumstances either succeeds or fails: in other words, it
makes a definite decision, and this is why it is anchored as &quot;last&quot; in the
rulebook. If users or extensions want to tweak accessibility at this
general level, any new rules they add will get the chance to decide before
the &quot;access through barriers&quot; rule settles the matter. But in practice
we expect most users to work with one of the two reaching rulebooks instead.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Section 5 - Accessibility</span>

<span class="plain-syntax">The access through barriers rule is listed last in the accessibility rules.</span>

<span class="plain-syntax">The access through barriers rule is defined by Inter as</span>
<span class="plain-syntax">    "ACCESS_THROUGH_BARRIERS_R" with</span>
<span class="plain-syntax">    "[regarding the noun][Those] [aren't] available." (A).</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP42" class="paragraph-anchor"></a><b>&#167;42. Reaching inside.</b>  What the access through barriers rule does is to try to construct a path
through the object containment tree from the actor to the item needed, and
to apply the reaching inside or reaching outside rulebooks each time this
path passes inside or outside of a container (or room). (Supporters never
form barriers.)</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">The can't reach inside rooms rule is listed last in the reaching inside rules. [Penultimate.]</span>
<span class="plain-syntax">The can't reach inside closed containers rule is listed last in the reaching</span>
<span class="plain-syntax">inside rules. [Last.]</span>

<span class="plain-syntax">The can't reach inside closed containers rule is defined by Inter as</span>
<span class="plain-syntax">    "CANT_REACH_INSIDE_CLOSED_R" with</span>
<span class="plain-syntax">    "[The noun] [aren't] open." (A).</span>
<span class="plain-syntax">The can't reach inside rooms rule is defined by Inter as</span>
<span class="plain-syntax">    "CANT_REACH_INSIDE_ROOMS_R" with</span>
<span class="plain-syntax">    "[We] [can't] reach into [the noun]." (A).</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP43" class="paragraph-anchor"></a><b>&#167;43. Reaching outside.</b>  And, not quite symmetrically since we don't need to block room-to-room
reaching on both the inbound and outbound directions,</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">The can't reach outside closed containers rule is listed last in the reaching outside rules.</span>

<span class="plain-syntax">The can't reach outside closed containers rule is defined by Inter as</span>
<span class="plain-syntax">    "CANT_REACH_OUTSIDE_CLOSED_R" with</span>
<span class="plain-syntax">    "[The noun] [aren't] open." (A).</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP44" class="paragraph-anchor"></a><b>&#167;44. Visibility.</b>  The visibility rulebook actually has the opposite sense to the one the name
might suggest. It is applied only when the player (not any other actor) tries
to perform an action which requires light to see by; the action is blocked
if the rulebook succeeds. (Well, but we could hardly call it the invisibility
rulebook. The name is supposed to suggest that the consideration of visibility
is being applied: rather the way cricket matches end with a declaration that
&quot;light stopped play&quot;, meaning of course that darkness did.)</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">The can't act in the dark rule is listed last in the visibility rules.</span>

<span class="plain-syntax">The last visibility rule (this is the can't act in the dark rule): if in darkness, rule succeeds.</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP45" class="paragraph-anchor"></a><b>&#167;45. Does the player mean.</b>  This rulebook is akin to a set of preferences about how to interpret the
player's commands in cases of ambiguity. No two Inform users are likely to
agree about the best way to decide these, so we are fairly hands-off, and
make only one rule as standard:</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Does the player mean taking something which is carried by the player</span>
<span class="plain-syntax">    (this is the very unlikely to mean taking what's already carried rule):</span>
<span class="plain-syntax">    it is very unlikely.</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP46" class="paragraph-anchor"></a><b>&#167;46. </b>  And that completes the creation and stocking of the 25 rulebooks. More than
half of them are initially empty, including before, instead and after -- at the
end of the day, these rulebooks are hooks allowing the user to change the
ordinary behaviour of things, but ordinariness is exactly what the Standard
Rules is all about.</p>
</div>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP47" class="paragraph-anchor"></a><b>&#167;47. Adjectives applied to values.</b>  There is a small stock of built-in adjectives for values.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Section 6 - Adjectival definitions</span>

<span class="plain-syntax">A scene can be recurring or non-recurring. A scene is usually non-recurring.</span>
<span class="plain-syntax">The Entire Game is recurring.</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP48" class="paragraph-anchor"></a><b>&#167;48. Scene descriptions.</b>  And there is one build-in value property for values.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Section 7 - Scene descriptions</span>

<span class="plain-syntax">A scene has a text called description.</span>
<span class="plain-syntax">When a scene (called the event) begins (this is the scene description text rule):</span>
<span class="plain-syntax">    if the description of the event is not "",</span>
<span class="plain-syntax">        say "[description of the event][paragraph break]".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP49" class="paragraph-anchor"></a><b>&#167;49. Command parser errors.</b>  This abstracts a set of return codes from the I6 parser, which are written
there as constants with the notation <code>*_ETYPE</code>.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Section 8 - Command parser errors</span>

<span class="plain-syntax">A command parser error is a kind of value. The command parser errors are</span>
<span class="plain-syntax">    didn't understand error,</span>
<span class="plain-syntax">    only understood as far as error,</span>
<span class="plain-syntax">    didn't understand that number error,</span>
<span class="plain-syntax">    can only do that to something animate error,</span>
<span class="plain-syntax">    can't see any such thing error,</span>
<span class="plain-syntax">    said too little error,</span>
<span class="plain-syntax">    aren't holding that error,</span>
<span class="plain-syntax">    can't use multiple objects error,</span>
<span class="plain-syntax">    can only use multiple objects error,</span>
<span class="plain-syntax">    not sure what it refers to error,</span>
<span class="plain-syntax">    excepted something not included error,</span>
<span class="plain-syntax">    not a verb I recognise error,</span>
<span class="plain-syntax">    not something you need to refer to error,</span>
<span class="plain-syntax">    can't see it at the moment error,</span>
<span class="plain-syntax">    didn't understand the way that finished error,</span>
<span class="plain-syntax">    not enough of those available error,</span>
<span class="plain-syntax">    nothing to do error,</span>
<span class="plain-syntax">    referred to a determination of scope error,</span>
<span class="plain-syntax">    noun did not make sense in that context error,</span>
<span class="plain-syntax">    I beg your pardon error,</span>
<span class="plain-syntax">    can't again the addressee error,</span>
<span class="plain-syntax">    comma can't begin error,</span>
<span class="plain-syntax">    can't see whom to talk to error,</span>
<span class="plain-syntax">    can't talk to inanimate things error, and</span>
<span class="plain-syntax">    didn't understand addressee's last name error.</span>

<span class="plain-syntax">The latest parser error is a command parser error that varies.</span>
<span class="plain-syntax">The latest parser error variable is defined by Inter as "etype".</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP50" class="paragraph-anchor"></a><b>&#167;50. Internal rules.</b>  These rules do nothing in themselves, and are really just hooks on which
some response texts can be hung.</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">Section 9 - Responses for internal rules</span>

<span class="plain-syntax">The list writer internal rule is defined by Inter as</span>
<span class="plain-syntax">    "LIST_WRITER_INTERNAL_R" with</span>
<span class="plain-syntax">    " (" (A),</span>
<span class="plain-syntax">    ")" (B),</span>
<span class="plain-syntax">    " and " (C),</span>
<span class="plain-syntax">    "providing light" (D),</span>
<span class="plain-syntax">    "closed" (E),</span>
<span class="plain-syntax">    "empty" (F),</span>
<span class="plain-syntax">    "closed and empty" (G),</span>
<span class="plain-syntax">    "closed and providing light" (H),</span>
<span class="plain-syntax">    "empty and providing light" (I),</span>
<span class="plain-syntax">    "closed, empty[if serial comma option is active],[end if] and providing light" (J),</span>
<span class="plain-syntax">    "providing light and being worn" (K),</span>
<span class="plain-syntax">    "being worn" (L),</span>
<span class="plain-syntax">    "open" (M),</span>
<span class="plain-syntax">    "open but empty" (N),</span>
<span class="plain-syntax">    "closed" (O),</span>
<span class="plain-syntax">    "closed and locked" (P),</span>
<span class="plain-syntax">    "containing" (Q),</span>
<span class="plain-syntax">    "on [if the noun is a person]whom[otherwise]which[end if] " (R),</span>
<span class="plain-syntax">    ", on top of [if the noun is a person]whom[otherwise]which[end if] " (S),</span>
<span class="plain-syntax">    "in [if the noun is a person]whom[otherwise]which[end if] " (T),</span>
<span class="plain-syntax">    ", inside [if the noun is a person]whom[otherwise]which[end if] " (U),</span>
<span class="plain-syntax">    "[regarding list writer internals][are]" (V),</span>
<span class="plain-syntax">    "[regarding list writer internals][are] nothing" (W),</span>
<span class="plain-syntax">    "Nothing" (X),</span>
<span class="plain-syntax">    "nothing" (Y).</span>

<span class="plain-syntax">The action processing internal rule is defined by Inter as</span>
<span class="plain-syntax">    "ACTION_PROCESSING_INTERNAL_R" with</span>
<span class="plain-syntax">    "[bracket]That command asks to do something outside of play, so it can</span>
<span class="plain-syntax">    only make sense from you to me. [The noun] cannot be asked to do this.[close</span>
<span class="plain-syntax">    bracket]" (A),</span>
<span class="plain-syntax">    "You must name an object." (B),</span>
<span class="plain-syntax">    "You may not name an object." (C),</span>
<span class="plain-syntax">    "You must supply a noun." (D),</span>
<span class="plain-syntax">    "You may not supply a noun." (E),</span>
<span class="plain-syntax">    "You must name a second object." (F),</span>
<span class="plain-syntax">    "You may not name a second object." (G),</span>
<span class="plain-syntax">    "You must supply a second noun." (H),</span>
<span class="plain-syntax">    "You may not supply a second noun." (I),</span>
<span class="plain-syntax">    "(Since something dramatic has happened, your list of commands has been</span>
<span class="plain-syntax">    cut short.)" (J),</span>
<span class="plain-syntax">    "I didn't understand that instruction." (K).</span>

<span class="plain-syntax">The parser error internal rule is defined by Inter as</span>
<span class="plain-syntax">    "PARSER_ERROR_INTERNAL_R" with</span>
<span class="plain-syntax">    "I didn't understand that sentence." (A),</span>
<span class="plain-syntax">    "I only understood you as far as wanting to " (B),</span>
<span class="plain-syntax">    "I only understood you as far as wanting to (go) " (C),</span>
<span class="plain-syntax">    "I didn't understand that number." (D),</span>
<span class="plain-syntax">    "[We] [can't] see any such thing." (E),</span>
<span class="plain-syntax">    "You seem to have said too little!" (F),</span>
<span class="plain-syntax">    "[We] [aren't] holding that!" (G),</span>
<span class="plain-syntax">    "You can't use multiple objects with that verb." (H),</span>
<span class="plain-syntax">    "You can only use multiple objects once on a line." (I),</span>
<span class="plain-syntax">    "I'm not sure what ['][pronoun i6 dictionary word]['] refers to." (J),</span>
<span class="plain-syntax">    "[We] [can't] see ['][pronoun i6 dictionary word]['] ([the noun]) at the moment." (K),</span>
<span class="plain-syntax">    "You excepted something not included anyway!" (L),</span>
<span class="plain-syntax">    "You can only do that to something animate." (M),</span>
<span class="plain-syntax">    "That's not a verb I [if American dialect option is</span>
<span class="plain-syntax">        active]recognize[otherwise]recognise[end if]." (N),</span>
<span class="plain-syntax">    "That's not something you need to refer to in the course of this game." (O),</span>
<span class="plain-syntax">    "I didn't understand the way that finished." (P),</span>
<span class="plain-syntax">    "[if number understood is 0]None[otherwise]Only [number understood in words][end if]</span>
<span class="plain-syntax">        of those [regarding the number understood][are] available." (Q),</span>
<span class="plain-syntax">    "That noun did not make sense in this context." (R),</span>
<span class="plain-syntax">    "To repeat a command like 'frog, jump', just say 'again', not 'frog, again'." (S),</span>
<span class="plain-syntax">    "You can't begin with a comma." (T),</span>
<span class="plain-syntax">    "You seem to want to talk to someone, but I can't see whom." (U),</span>
<span class="plain-syntax">    "You can't talk to [the noun]." (V),</span>
<span class="plain-syntax">    "To talk to someone, try 'someone, hello' or some such." (W),</span>
<span class="plain-syntax">    "I beg your pardon?" (X).</span>

<span class="plain-syntax">The parser nothing error internal rule is defined by Inter as</span>
<span class="plain-syntax">    "PARSER_N_ERROR_INTERNAL_R" with</span>
<span class="plain-syntax">    "Nothing to do!" (A),</span>
<span class="plain-syntax">    "[There] [adapt the verb are from the third person plural] none at all available!" (B),</span>
<span class="plain-syntax">    "[The noun] [have] nothing." (C),</span>
<span class="plain-syntax">    "[regarding the noun][Those] [can't] contain things." (D),</span>
<span class="plain-syntax">    "[The noun] [aren't] open." (E),</span>
<span class="plain-syntax">    "[The noun] [are] empty." (F).</span>

<span class="plain-syntax">The darkness name internal rule is defined by Inter as "DARKNESS_NAME_INTERNAL_R" with</span>
<span class="plain-syntax">    "Darkness" (A).</span>

<span class="plain-syntax">The parser command internal rule is defined by Inter as</span>
<span class="plain-syntax">    "PARSER_COMMAND_INTERNAL_R" with</span>
<span class="plain-syntax">    "Sorry, that can't be corrected." (A),</span>
<span class="plain-syntax">    "Think nothing of it." (B),</span>
<span class="plain-syntax">    "'Oops' can only correct a single word." (C),</span>
<span class="plain-syntax">    "You can hardly repeat that." (D).</span>

<span class="plain-syntax">The parser clarification internal rule is defined by Inter as</span>
<span class="plain-syntax">    "PARSER_CLARIF_INTERNAL_R" with</span>
<span class="plain-syntax">    "Who do you mean, " (A),</span>
<span class="plain-syntax">    "Which do you mean, " (B),</span>
<span class="plain-syntax">    "Sorry, you can only have one item here. Which exactly?" (C),</span>
<span class="plain-syntax">    "Whom do you want [if the noun is not the player][the noun] [end if]to</span>
<span class="plain-syntax">        [parser command so far]?" (D),</span>
<span class="plain-syntax">    "What do you want [if the noun is not the player][the noun] [end if]to</span>
<span class="plain-syntax">        [parser command so far]?" (E),</span>
<span class="plain-syntax">    "those things" (F),</span>
<span class="plain-syntax">    "that" (G),</span>
<span class="plain-syntax">    " or " (H).</span>

<span class="plain-syntax">The yes or no question internal rule is defined by Inter as</span>
<span class="plain-syntax">    "YES_OR_NO_QUESTION_INTERNAL_R" with</span>
<span class="plain-syntax">    "Please answer yes or no." (A).</span>

<span class="plain-syntax">The pick a number internal rule is defined by Inter as</span>
<span class="plain-syntax">    "PICK_A_NUMBER_INTERNAL_R" with</span>
<span class="plain-syntax">    "(Please type an option in the range 1 to [number understood] and press return.)" (A).</span>

<span class="plain-syntax">The print protagonist internal rule is defined by Inter as</span>
<span class="plain-syntax">    "PRINT_PROTAGONIST_INTERNAL_R" with</span>
<span class="plain-syntax">    "[We]" (A),</span>
<span class="plain-syntax">    "[ourselves]" (B),</span>
<span class="plain-syntax">    "[our] former self" (C).</span>
</pre>
<nav role="progress"><div class="progresscontainer">
    <ul class="progressbar"><li class="progressprev"><a href="pwm.html">&#10094;</a></li><li class="progresssection"><a href="prmbl.html">prmbl</a></li><li class="progresssection"><a href="pwm.html">pwm</a></li><li class="progresscurrent">var</li><li class="progresssection"><a href="dlg.html">dlg</a></li><li class="progresssection"><a href="actvt.html">actvt</a></li><li class="progresssection"><a href="actns.html">actns</a></li><li class="progresssection"><a href="cmgr.html">cmgr</a></li><li class="progresssection"><a href="phdf.html">phdf</a></li><li class="progressnext"><a href="dlg.html">&#10095;</a></li></ul></div>
</nav><!-- End of weave -->

		</main>
	</body>
</html>

