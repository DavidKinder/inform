<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<title>Structure of the Inform 7 compiler</title>
<link href="docs-assets/Breadcrumbs.css" rel="stylesheet" rev="stylesheet" type="text/css">
		<meta name="viewport" content="width=device-width initial-scale=1">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="Content-Language" content="en-gb">

<link href="docs-assets/Contents.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="docs-assets/Progress.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="docs-assets/Navigation.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="docs-assets/Fonts.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="docs-assets/Base.css" rel="stylesheet" rev="stylesheet" type="text/css">
<script src="http://code.jquery.com/jquery-1.12.4.min.js"
	integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>

<script src="docs-assets/Bigfoot.js"></script>
<link href="docs-assets/Bigfoot.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="docs-assets/Colours.css" rel="stylesheet" rev="stylesheet" type="text/css">
		
	</head>
	<body class="commentary-font">
		<nav role="navigation">
		<h1><a href="index.html"><img src="docs-assets/Inform.png" height=72> </a></h1>
<ul><li><a href="index.html"><span class="selectedlink">home</span></a></li>
</ul><h2>Compiler</h2><ul>
<li><span class="unlink">structure</span></li>
<li><a href="inbuildn.html">inbuild</a></li>
<li><a href="inform7n.html">inform7</a></li>
<li><a href="intern.html">inter</a></li>
<li><a href="services.html">services</a></li>
<li><a href="secrets.html">secrets</a></li>
</ul><h2>Other Tools</h2><ul>
<li><a href="inblorbn.html">inblorb</a></li>
<li><a href="inform6.html">inform6</a></li>
<li><a href="inpolicyn.html">inpolicy</a></li>
</ul><h2>Resources</h2><ul>
<li><a href="extensions.html">extensions</a></li>
<li><a href="kits.html">kits</a></li>
</ul><h2>Repository</h2><ul>
<li><a href="https://github.com/ganelson/inform"><img src="docs-assets/github.png" height=0> github</a></li>
</ul><h2>Related Projects</h2><ul>
<li><a href="https://github.com/ganelson/inweb"><img src="docs-assets/github.png" height=0> inweb</a></li>
<li><a href="https://github.com/ganelson/intest"><img src="docs-assets/github.png" height=0> intest</a></li>
</ul>
		</nav>
		<main role="main">
		<!-- Weave of 'Structure of the Inform 7 compiler' generated by inweb -->
<div class="breadcrumbs">
    <ul class="crumbs"><li><a href="index.html">Home</a></li><li><b>Structure of the Inform 7 compiler</b></li></ul></div>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP1" class="paragraph-anchor"></a><b>&#167;1. </b>  @ The core Inform compiler combines natural-language source text, including
natural-language extensions, and precompiled &quot;kits&quot; in order to make the
instructions for making a playable story. Inform is internally divided into
Stages, numbered 1 to 7. (These slightly overlap in chronological order, but
they do mostly happen in sequence.)</p>
<p>(1) Build management: gathering up what must be compiled and reading it in as
an annotated syntax tree, or &quot;AST&quot;. (AST normally stands for &quot;abstract syntax
tree&quot; but we prefer &quot;annotated&quot;, skirting the issue of exactly how abstract vs concrete it is.)</p>
<p>(2) Queueing and organising work which will be done by stages 3 to 5.</p>
<p>(3) Turning assertion sentences -- &quot;Peter is a man&quot;, &quot;The tally is a number
that varies&quot; -- into a world model of variables, kinds, instances and properties.
Values and typechecking are also managed here. Phrases and rules are identified,
but their bodies are ignored for the moment.</p>
<p>(4) The world model, phrases and rules identified by stage (3) are now compiled
to an Intermediate Representation, or &quot;IR&quot;, another sort of tree known as Inter.
This is done by calling down to the API provided by...</p>
<p>(5) ... which is more a layer than a stage: it's a comprehensive system for
building Inter code, and could conceivably be used by other compilers too.</p>
<p>(6) A &quot;pipeline&quot; of transformations on the Inter code improves it. A weak form
of linker joins on precompiled Inter code from &quot;kits&quot; such as BasicInformKit
or WorldModelKit.</p>
<p>(7) The finished Inter tree is then code-generated to form our output, which
can be in several different formats, and an Index mini-website about it is made.
For most users of the Inform app, the format will be Inform 6, and further
command-line tools <a href="inform6.html" class="internal">inform6</a> and <a href="inblorb/index.html" class="internal">inblorb</a> then turn that into a &quot;story
file&quot; and then a Javascript-running web page; but for some command-line users,
the format is C and a compiler like |clang| is then used to make an executable.</p>
<p>@ These seven stages form a single code base but are packaged up into three
command-line tools, not one:</p>
<ul>
<li>|inbuild| is Stage 1 as a stand-alone tool: see <a href="inbuildn.html" class="internal">this description</a>.</li>
<li>|inform7| is Stages 1 to 7 as an all-in-one: see <a href="inform7n.html" class="internal">this description</a>
of the part unique to it, Stages 2 to 4.</li>
<li>|inter| is Stages 5 to 7 as a stand-alone tool: see <a href="intern.html" class="internal">this description</a>.</li>
</ul>
<p>All three tools also use a large library of <a href="services.html" class="internal">services</a>: everything from
inflecting words to simplifying logical propositions.</p>
<p>@ The flow of data looks like so, with time running downwards on the page:
= (hyperlinked text as BoxArt)
kit sources
(in Inform 6 code)
|</p>
</div>
<pre class="displayed-code all-displayed-code code-font">
<span class="plain-syntax">    | INTER</span>
<span class="plain-syntax">   \|/</span>
<span class="plain-syntax">precompiled</span>
<span class="plain-syntax">Inter trees</span>
<span class="plain-syntax">    .                main source text    extension source texts</span>
<span class="plain-syntax">    .                             \           /</span>
<span class="plain-syntax">    .                              \         /  INFORM7 Stage 1 or INBUILD</span>
<span class="plain-syntax">    .                               \       /</span>
<span class="plain-syntax">    .                               \|/   \|/</span>
<span class="plain-syntax">    .                              syntax tree</span>
<span class="plain-syntax">    .                                   |</span>
<span class="plain-syntax">    .                                   |  INFORM7 Stages 2 to 4/5</span>
<span class="plain-syntax">    .                                   |</span>
<span class="plain-syntax">    . . . . . . . precompiled          \|/</span>
<span class="plain-syntax">                  Inter trees      Inter tree</span>
<span class="plain-syntax">                        \              /</span>
<span class="plain-syntax">                         \            /  INFORM7 Stage 6 or INTER</span>
<span class="plain-syntax">                         \|/        \|/</span>
<span class="plain-syntax">                    single linked Inter tree</span>
<span class="plain-syntax">                        /       |       \</span>
<span class="plain-syntax">                       /        |        \   INFORM7 Stage 7 or INTER</span>
<span class="plain-syntax">                     \|/       \|/       \|/</span>
<span class="plain-syntax">             Inform 6 code   C code     index mini-website</span>
<span class="plain-syntax">                      :         :</span>
<span class="plain-syntax">             INFORM6  :         :  CLANG or GCC</span>
<span class="plain-syntax">                     \:/       \:/</span>
<span class="plain-syntax">               story file   executable</span>
<span class="plain-syntax">                      :</span>
<span class="plain-syntax">             INBLORB  :</span>
<span class="plain-syntax">                     \:/</span>
<span class="plain-syntax">             playable website</span>
</pre>
<div class="lsmarkdown">
<p class="commentary firstcommentary"><a id="SP2" class="paragraph-anchor"></a><b>&#167;2. </b>  =</p>
<p>@ The code base is subdivided into &quot;modules&quot;. There are around 30, from five sources:</p>
<ul>
<li>A set of <a href="services.html" class="internal">services</a>, which are libraries of code providing features useful
to programs dealing with natural language.</li>
<li>Those <a href="inbuildn.html" class="internal">owned by Inbuild</a>.</li>
<li>Those <a href="inform7n.html" class="internal">owned by Inform7</a>.</li>
<li>Those <a href="intern.html" class="internal">owned by Inter</a>.</li>
<li>The <a href="foundation/index.html" class="internal">foundation</a> library for memory-management, string handling and so
on, which is a module held in the <a href="inweb/index.html" class="internal">inweb</a> repository rather than here.</li>
</ul>
<p>@ The full breakdown of the three compiler tools into modules is as follows.
An |o| means that the tool is the owner of the module in question; a |x| means
that it imports the module from somewhere else.</p>
<h1>= (hyperlinked text as BoxArt)
WEB                 ACTIVE STAGES   INWEB    SERVICES    INBUILD     INFORM7     INTER</h1>
<p>The executables otherwise contain only a few POSIX or Windows-related functions
for file and directory handling, and functions from the standard C library.
There are, therefore, no external dependencies.</p>
</div>
<!-- End of weave -->

		</main>
	</body>
</html>

